#!/bin/bash

FILE=/home/work/terminal/notes/buglist.html
OUTPUT=/home/work/terminal/newfile.html

COMPONENT=$1
TEXT=$2

if [ -z "$TEXT" -o -n "$3" ]; then
	echo "Usage: $(basename $0) [gt|vt] newbug 'text'"
	exit 1
fi

exec 1> $OUTPUT
head -n -3 $FILE

BUG_NUM=$(echo $TEXT | sed 's/\[Bug \([0-9]\+\)\].*/\1/')
BUG_TXT=$(echo $TEXT | sed 's/\[Bug \([0-9]\+\)\] *//')
echo -n "      <tr> "
echo -n "<td><a href=\"http://bugzilla.gnome.org/show_bug.cgi?id=$BUG_NUM\">$BUG_NUM</a></td> "
echo -n "<td>$COMPONENT</td> "
echo -n "<td>nor</td> "
echo -n "<td>$BUG_TXT</td> "
echo    "</tr>"
echo "Added: Bug $BUG_NUM: $BUG_TXT" > /dev/stderr

tail -3 $FILE

mv $OUTPUT $FILE
