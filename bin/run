#!/bin/bash

function error()
{
	echo -e "$@"
	exit 1
}


FILE="run.txt"
DIR="/home/flatcap/todo"
DATE="$(date '+%Y-%m-%d')"

[ $# = 2 ]          || error "Usage: ${0##*/} miles mins"
[ -d "$DIR"  ]      || error "Directory doesn't exist: $DIR"
[ -f "$DIR/$FILE" ] || error "File doesn't exist: $DIR/$FILE"

# Allow a number with optional 10th, e.g.  24, 24.5
[[ "$1" =~ ^[0-9]+(\.[0-9])*$ ]] || error "Miles isn't numeric: $1"
[[ "$2" =~ ^[0-9]+(\.[0-9])*$ ]] || error "Mins isn't numeric: $2"

cd "$DIR"

echo "Run:"
echo -e "\t$DATE\t$1 miles, $2 mins" | tee -a "$FILE"

git commit --quiet "run.txt" -m "run"
git push --quiet

